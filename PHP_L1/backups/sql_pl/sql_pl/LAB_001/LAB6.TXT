--   1. 
SELECT   JOB,ENAME,SAL
FROM     EMP
WHERE    (SAL,JOB) IN (SELECT MAX(SAL),JOB FROM EMP GROUP BY JOB)
ORDER BY SAL DESC;

--   2.              
SELECT   JOB,ENAME,SAL
FROM     EMP
WHERE    (SAL,JOB) IN (SELECT MIN(SAL),JOB FROM EMP GROUP BY JOB)
ORDER BY SAL;

--3. 
SELECT   DEPTNO, ENAME, HIREDATE
FROM     EMP
WHERE    (HIREDATE,DEPTNO) IN (SELECT MAX(HIREDATE), DEPTNO 
FROM     EMP 
GROUP BY DEPTNO)
ORDER BY HIREDATE;


--4. 
SELECT   ENAME, SAL SALARY, DEPTNO
FROM     EMP E
WHERE    SAL > (SELECT AVG(SAL) FROM EMP WHERE DEPTNO=E.DEPTNO)
ORDER BY DEPTNO;


--5.
SELECT   DEPTNO, DNAME
FROM     DEPT D
WHERE    NOT EXISTS (SELECT'anything'FROM EMP WHERE DEPTNO=D.DEPTNO);


--6. 
DEFINE   REM = SAL*12+NVL(COMM,0);

SELECT   DEPTNO, SUM(&REM) COMPENSATION
FROM     EMP
GROUP BY DEPTNO
HAVING   SUM(&REM) = (SELECT MAX(SUM(&REM))
FROM     EMP
GROUP BY DEPTNO);

UNDEFINE REM ;

--7. 
SELECT    ENAME, SAL
FROM      EMP E
WHERE     3 > (SELECT COUNT(*) FROM EMP WHERE E.SAL < SAL);


--8.
SELECT   TO_CHAR(HIREDATE,'YYYY') YEAR, COUNT(EMPNO) NUMBER_OF_EMPS
FROM     EMP
GROUP BY TO_CHAR(HIREDATE,'YYYY')
HAVING   COUNT(EMPNO) = (SELECT MAX(COUNT(EMPNO))
FROM EMP
GROUP BY TO_CHAR(HIREDATE,'YYYY'));


--9.
SELECT    E.ENAME ENAME, E.SAL, E.DEPTNO, AVG(A.SAL) DEPT_AVG
FROM      EMP A, EMP E
WHERE     E.DEPTNO = A.DEPTNO
AND       E.SAL>(SELECT AVG(SAL) 
FROM EMP
WHERE     DEPTNO = E.DEPTNO)
GROUP BY  E.ENAME, E.SAL,E.DEPTNO
ORDER BY  AVG(A.SAL);


--10.
SELECT    ENAME, HIREDATE,'*' MAXDATE
FROM      EMP
WHERE     HIREDATE = (SELECT MAX(HIREDATE) FROM EMP)
UNION
SELECT    ENAME, HIREDATE,''
FROM      EMP
WHERE     HIREDATE <> (SELECT MAX(HIREDATE) FROM EMP);
