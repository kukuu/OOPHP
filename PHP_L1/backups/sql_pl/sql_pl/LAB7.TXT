/** 
//Oracle SQL labs.
//Oguzhan KOKSAL
//Lab 7, 18th April 1997
**/

--ANSWER 1
SET ECHO OFF
SET PAGESIZE 24
SET FEEDBACK OFF
SET LINESIZE 78

COL A FORMAT A10 HEADING 'Department'
COL B FORMAT A9 HEADING 'Job'
COL C FORMAT 9999 HEADING 'Emp. No.'
COL D FORMAT A8 HEADING 'Name'
COL E FORMAT A5 HEADING 'Hire Date'
COL F FORMAT B99,999.99 HEADING 'Monthly Salary'
COL G FORMAT 9,990.99 HEADING 'Annual Comm'
COL H FORMAT 999,999.99 HEADING 'Total'
BREAK ON A SKIP 1 ON B

TTITLE 'EMPLOYEE REPORT'
BTITLE 'CONFIDENTIAL'

SELECT	DNAME A, JOB B, EMPNO C, ENAME D, TO_CHAR(HIREDATE,'MM/YY') E,
	SAL F, COMM G, SAL*12+NVL(COMM,0) H
FROM	SCOTT.EMP E, SCOTT.DEPT D
WHERE E.DEPTNO=D.DEPTNO
ORDER BY DNAME,JOB
/

CLEAR COLUMNS
TTITLE OFF
BTITLE OFF
SET FEEDBACK ON
SET PAGESIZE 24
CLEAR BREAKS


--ANSWER 2
DROP	VIEW AGGREGATES ;

CREATE	VIEW AGGREGATES
	(DEPTNO, AVERAGE, MAXIMUM, MINIMUM, SUM, NO_SALS, NO_COMMS)
AS
SELECT	DEPTNO, AVG(SAL), MAX(SAL), MIN(SAL), SUM(SAL), COUNT(SAL), COUNT(COMM)
FROM	SCOTT.EMP
GROUP BY DEPTNO;

--ANSWER 3

SELECT	EMP.EMPNO, ENAME, JOB, SAL, HIREDATE, MINIMUM, MAXIMUM, AVERAGE
FROM	SCOTT.EMP, AGGREGATES AGG
WHERE	EMP.DEPTNO=AGG.DEPTNO
AND	EMP.EMPNO=(&EMPNO);
7566


--ANSWER 4

SELECT	LEVEL, DEPTNO, EMPNO, ENAME, JOB, SAL
FROM	SCOTT.EMP
CONNECT BY PRIOR EMPNO=MGR
START WITH MGR=NULL;


